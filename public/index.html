<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Avaliação de Desempenho</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #4A90D9;
            --primary-light: #E8F4FD;
            --bg: #F8FAFB;
            --white: #FFFFFF;
            --gray-light: #F3F4F6;
            --gray-medium: #9CA3AF;
            --gray-dark: #374151;
            --text: #1F2937;
            --border: #E5E7EB;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --sidebar-width: 260px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            overflow-x: hidden;
        }

        /* Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--white);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            z-index: 1000;
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 24px 20px;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            font-size: 24px;
        }

        .menu {
            padding: 20px 0;
        }

        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--gray-dark);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            font-weight: 500;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background: var(--primary-light);
            color: var(--primary);
        }

        .menu-item.active {
            background: var(--primary-light);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .menu-item i {
            width: 20px;
            text-align: center;
        }

        /* Mobile Menu */
        .mobile-header {
            display: none;
            background: var(--white);
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 999;
            justify-content: space-between;
            align-items: center;
        }

        .hamburger {
            font-size: 24px;
            cursor: pointer;
            color: var(--primary);
        }

        .mobile-logo {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            flex: 1;
            padding: 32px;
            transition: margin-left 0.3s ease;
        }

        .page-header {
            margin-bottom: 32px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 8px;
        }

        .page-subtitle {
            color: var(--gray-medium);
            font-size: 14px;
        }

        /* Cards */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--white);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .stat-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }

        .stat-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .stat-card-icon {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .stat-card-icon.blue { background: var(--primary-light); color: var(--primary); }
        .stat-card-icon.green { background: #D1FAE5; color: var(--success); }
        .stat-card-icon.yellow { background: #FEF3C7; color: var(--warning); }
        .stat-card-icon.purple { background: #EDE9FE; color: #8B5CF6; }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--gray-medium);
        }

        /* Content Card */
        .content-card {
            background: var(--white);
            border-radius: 12px;
            padding: 28px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--text);
        }

        /* Forms */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: var(--text);
            margin-bottom: 8px;
        }

        .form-label .required {
            color: var(--danger);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            font-family: 'Inter', sans-serif;
            transition: all 0.2s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* File Upload */
        .file-upload-area {
            border: 2px dashed var(--border);
            border-radius: 8px;
            padding: 32px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .file-upload-area:hover {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .file-upload-icon {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 12px;
        }

        #photoPreview {
            max-width: 200px;
            max-height: 200px;
            margin: 16px auto;
            border-radius: 8px;
            display: none;
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: 'Inter', sans-serif;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #3A7BC8;
            box-shadow: 0 4px 12px rgba(74, 144, 217, 0.3);
        }

        .btn-secondary {
            background: var(--gray-light);
            color: var(--text);
        }

        .btn-secondary:hover {
            background: #E5E7EB;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #DC2626;
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        /* Employee Cards */
        .employees-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .employee-card {
            background: var(--white);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid var(--border);
            transition: all 0.3s;
            text-align: center;
        }

        .employee-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }

        .employee-photo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 16px;
            border: 3px solid var(--primary-light);
        }

        .employee-photo.default {
            background: var(--primary-light);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 600;
        }

        .employee-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 4px;
        }

        .employee-role {
            font-size: 14px;
            color: var(--gray-medium);
            margin-bottom: 2px;
        }

        .employee-dept {
            font-size: 13px;
            color: var(--primary);
            background: var(--primary-light);
            padding: 4px 12px;
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 12px;
        }

        .employee-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            justify-content: center;
        }

        .btn-icon {
            padding: 8px 12px;
            font-size: 13px;
        }

        /* Rating Stars */
        .rating-group {
            margin-bottom: 24px;
        }

        .rating-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .rating-description {
            font-size: 12px;
            color: var(--gray-medium);
            font-weight: 400;
        }

        .stars {
            display: flex;
            gap: 8px;
            margin-bottom: 4px;
        }

        .star {
            font-size: 28px;
            color: var(--border);
            cursor: pointer;
            transition: all 0.2s;
        }

        .star:hover,
        .star.active {
            color: #FCD34D;
        }

        .rating-value {
            font-size: 13px;
            color: var(--gray-medium);
            margin-top: 4px;
        }

        /* Evaluation List */
        .evaluation-item {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 12px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .evaluation-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .evaluation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .evaluation-employee {
            font-size: 16px;
            font-weight: 600;
            color: var(--text);
        }

        .evaluation-score {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
        }

        .evaluation-meta {
            display: flex;
            gap: 20px;
            font-size: 13px;
            color: var(--gray-medium);
        }

        .evaluation-meta i {
            margin-right: 6px;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .badge.exceptional { background: #D1FAE5; color: var(--success); }
        .badge.above { background: #DBEAFE; color: #2563EB; }
        .badge.meets { background: #FEF3C7; color: var(--warning); }
        .badge.below { background: #FEE2E2; color: var(--danger); }
        .badge.unsatisfactory { background: #FEE2E2; color: #991B1B; }

        /* Detail View */
        .detail-section {
            margin-bottom: 24px;
        }

        .detail-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border);
        }

        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .criteria-item {
            background: var(--gray-light);
            padding: 12px 16px;
            border-radius: 8px;
        }

        .criteria-name {
            font-size: 13px;
            color: var(--gray-dark);
            margin-bottom: 4px;
        }

        .criteria-score {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }

        .text-content {
            background: var(--gray-light);
            padding: 16px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text);
            white-space: pre-wrap;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
        }

        .empty-icon {
            font-size: 64px;
            color: var(--gray-medium);
            margin-bottom: 16px;
        }

        .empty-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 8px;
        }

        .empty-text {
            color: var(--gray-medium);
            margin-bottom: 20px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .mobile-header {
                display: flex;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .page-title {
                font-size: 24px;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .employees-grid {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .evaluation-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .evaluation-meta {
                flex-direction: column;
                gap: 8px;
            }

            .criteria-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        .mt-4 { margin-top: 16px; }
        .mb-4 { margin-bottom: 16px; }

        /* Overlay for mobile */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }

        /* Progress Bar for Score */
        .score-visual {
            margin-top: 16px;
            background: var(--gray-light);
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
        }

        .score-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--danger), var(--warning), var(--success));
            transition: width 0.3s ease;
            border-radius: 6px;
        }

        .no-employees-yet {
            text-align: center;
            padding: 40px;
            background: var(--primary-light);
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .no-employees-yet i {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 12px;
        }

        /* Loading spinner */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--gray-medium);
        }

        .loading i {
            font-size: 32px;
            animation: spin 1s linear infinite;
            margin-bottom: 12px;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="overlay" id="overlay"></div>
    
    <!-- Mobile Header -->
    <div class="mobile-header">
        <div class="hamburger" id="hamburger">
            <i class="fas fa-bars"></i>
        </div>
        <div class="mobile-logo">
            <i class="fas fa-chart-line"></i> Avaliação
        </div>
        <div style="width: 24px;"></div>
    </div>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-chart-line"></i>
                    <span>Avaliação RH</span>
                </div>
            </div>
            <nav class="menu">
                <div class="menu-item active" data-page="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </div>
                <div class="menu-item" data-page="employees">
                    <i class="fas fa-users"></i>
                    <span>Funcionários</span>
                </div>
                <div class="menu-item" data-page="new-employee">
                    <i class="fas fa-user-plus"></i>
                    <span>Novo Funcionário</span>
                </div>
                <div class="menu-item" data-page="evaluation">
                    <i class="fas fa-clipboard-check"></i>
                    <span>Nova Avaliação</span>
                </div>
                <div class="menu-item" data-page="history">
                    <i class="fas fa-history"></i>
                    <span>Histórico</span>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="page-dashboard" class="page">
                <div class="page-header">
                    <h1 class="page-title">Dashboard</h1>
                    <p class="page-subtitle">Visão geral do desempenho da equipe</p>
                </div>

                <div class="cards-grid">
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div>
                                <div class="stat-value" id="totalEmployees">0</div>
                                <div class="stat-label">Total de Funcionários</div>
                            </div>
                            <div class="stat-card-icon blue">
                                <i class="fas fa-users"></i>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div>
                                <div class="stat-value" id="totalEvaluations">0</div>
                                <div class="stat-label">Avaliações Realizadas</div>
                            </div>
                            <div class="stat-card-icon green">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div>
                                <div class="stat-value" id="pendingEvaluations">0</div>
                                <div class="stat-label">Avaliações Pendentes</div>
                            </div>
                            <div class="stat-card-icon yellow">
                                <i class="fas fa-clock"></i>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div>
                                <div class="stat-value" id="averageScore">-</div>
                                <div class="stat-label">Média Geral</div>
                            </div>
                            <div class="stat-card-icon purple">
                                <i class="fas fa-star"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content-card">
                    <h2 class="card-title">Desempenho da Equipe</h2>
                    <div class="score-visual">
                        <div class="score-bar" id="teamScoreBar" style="width: 0%"></div>
                    </div>
                    <p class="mt-4" style="text-align: center; color: var(--gray-medium); font-size: 14px;">
                        <span id="teamPerformanceText">Nenhuma avaliação realizada ainda</span>
                    </p>
                </div>

                <div class="content-card">
                    <h2 class="card-title">Avaliações Recentes</h2>
                    <div id="recentEvaluations"></div>
                </div>
            </div>

            <!-- Employees Page -->
            <div id="page-employees" class="page hidden">
                <div class="page-header">
                    <h1 class="page-title">Funcionários</h1>
                    <p class="page-subtitle">Gerencie sua equipe</p>
                </div>

                <div class="employees-grid" id="employeesList"></div>
            </div>

            <!-- New Employee Page -->
            <div id="page-new-employee" class="page hidden">
                <div class="page-header">
                    <h1 class="page-title">Novo Funcionário</h1>
                    <p class="page-subtitle">Cadastre um novo membro da equipe</p>
                </div>

                <div class="content-card">
                    <form id="employeeForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Nome Completo <span class="required">*</span></label>
                                <input type="text" class="form-input" id="empName" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Cargo <span class="required">*</span></label>
                                <input type="text" class="form-input" id="empRole" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Departamento <span class="required">*</span></label>
                                <select class="form-select" id="empDepartment" required>
                                    <option value="">Selecione...</option>
                                    <option value="TI">TI</option>
                                    <option value="RH">RH</option>
                                    <option value="Financeiro">Financeiro</option>
                                    <option value="Comercial">Comercial</option>
                                    <option value="Marketing">Marketing</option>
                                    <option value="Operações">Operações</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Email <span class="required">*</span></label>
                                <input type="email" class="form-input" id="empEmail" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Data de Admissão <span class="required">*</span></label>
                                <input type="date" class="form-input" id="empAdmission" required>
                            </div>

                            <div class="form-group full-width">
                                <label class="form-label">Foto do Funcionário</label>
                                <div class="file-upload-area" id="uploadArea">
                                    <div class="file-upload-icon">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                    </div>
                                    <p style="color: var(--gray-medium); font-size: 14px;">
                                        Clique ou arraste uma foto aqui
                                    </p>
                                    <input type="file" id="empPhoto" accept="image/*" style="display: none;">
                                </div>
                                <img id="photoPreview" alt="Preview">
                            </div>
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Salvar Funcionário
                            </button>
                            <button type="button" class="btn btn-secondary" id="cancelEmployee">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Evaluation Page -->
            <div id="page-evaluation" class="page hidden">
                <div class="page-header">
                    <h1 class="page-title">Nova Avaliação</h1>
                    <p class="page-subtitle">Avalie o desempenho de um funcionário</p>
                </div>

                <div class="content-card">
                    <form id="evaluationForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Funcionário <span class="required">*</span></label>
                                <select class="form-select" id="evalEmployee" required>
                                    <option value="">Selecione um funcionário...</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Período <span class="required">*</span></label>
                                <input type="text" class="form-input" id="evalPeriod" placeholder="Ex: Janeiro 2024" required>
                            </div>
                        </div>

                        <h3 class="card-title mt-4">Critérios de Avaliação</h3>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Qualidade do Trabalho</span>
                                <span class="rating-description">Precisão, atenção aos detalhes</span>
                            </div>
                            <div class="stars" data-criterion="quality"></div>
                            <div class="rating-value"></div>
                        </div>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Produtividade</span>
                                <span class="rating-description">Volume e eficiência na entrega</span>
                            </div>
                            <div class="stars" data-criterion="productivity"></div>
                            <div class="rating-value"></div>
                        </div>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Conhecimento Técnico</span>
                                <span class="rating-description">Domínio das habilidades necessárias</span>
                            </div>
                            <div class="stars" data-criterion="technical"></div>
                            <div class="rating-value"></div>
                        </div>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Trabalho em Equipe</span>
                                <span class="rating-description">Colaboração e comunicação</span>
                            </div>
                            <div class="stars" data-criterion="teamwork"></div>
                            <div class="rating-value"></div>
                        </div>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Iniciativa e Proatividade</span>
                                <span class="rating-description">Capacidade de antecipar e resolver</span>
                            </div>
                            <div class="stars" data-criterion="initiative"></div>
                            <div class="rating-value"></div>
                        </div>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Pontualidade e Assiduidade</span>
                                <span class="rating-description">Comprometimento com horários</span>
                            </div>
                            <div class="stars" data-criterion="punctuality"></div>
                            <div class="rating-value"></div>
                        </div>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Liderança</span>
                                <span class="rating-description">Capacidade de influenciar e guiar</span>
                            </div>
                            <div class="stars" data-criterion="leadership"></div>
                            <div class="rating-value"></div>
                        </div>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Adaptabilidade</span>
                                <span class="rating-description">Flexibilidade diante de mudanças</span>
                            </div>
                            <div class="stars" data-criterion="adaptability"></div>
                            <div class="rating-value"></div>
                        </div>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Comunicação</span>
                                <span class="rating-description">Clareza e eficácia na comunicação</span>
                            </div>
                            <div class="stars" data-criterion="communication"></div>
                            <div class="rating-value"></div>
                        </div>

                        <div class="rating-group">
                            <div class="rating-label">
                                <span>Alinhamento com Valores</span>
                                <span class="rating-description">Aderência à cultura organizacional</span>
                            </div>
                            <div class="stars" data-criterion="values"></div>
                            <div class="rating-value"></div>
                        </div>

                        <h3 class="card-title mt-4">Feedback Qualitativo</h3>

                        <div class="form-group">
                            <label class="form-label">Pontos Fortes</label>
                            <textarea class="form-textarea" id="evalStrengths" placeholder="Descreva os principais pontos fortes do funcionário..."></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Pontos de Melhoria</label>
                            <textarea class="form-textarea" id="evalImprovements" placeholder="Identifique áreas que necessitam desenvolvimento..."></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Plano de Desenvolvimento Individual (PDI)</label>
                            <textarea class="form-textarea" id="evalPDI" placeholder="Defina metas e ações para o desenvolvimento do funcionário..."></textarea>
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Salvar Avaliação
                            </button>
                            <button type="button" class="btn btn-secondary" id="cancelEvaluation">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- History Page -->
            <div id="page-history" class="page hidden">
                <div class="page-header">
                    <h1 class="page-title">Histórico de Avaliações</h1>
                    <p class="page-subtitle">Visualize todas as avaliações realizadas</p>
                </div>

                <div class="content-card">
                    <div id="evaluationsList"></div>
                </div>
            </div>

            <!-- Evaluation Detail (Dynamic) -->
            <div id="page-evaluation-detail" class="page hidden">
                <div class="page-header">
                    <h1 class="page-title" id="detailTitle">Detalhes da Avaliação</h1>
                    <p class="page-subtitle" id="detailSubtitle"></p>
                </div>

                <div class="content-card">
                    <div id="evaluationDetail"></div>
                    <div class="btn-group">
                        <button type="button" class="btn btn-secondary" id="backToHistory">
                            <i class="fas fa-arrow-left"></i> Voltar ao Histórico
                        </button>
                        <button type="button" class="btn btn-danger" id="deleteEvaluation">
                            <i class="fas fa-trash"></i> Excluir Avaliação
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ===========================================
        // API Client - All communication with backend
        // ===========================================
        const API = {
            baseURL: '',

            async request(url, options = {}) {
                try {
                    const response = await fetch(this.baseURL + url, options);
                    const data = await response.json();
                    if (!response.ok) {
                        throw new Error(data.error || 'Erro na requisição');
                    }
                    return data;
                } catch (err) {
                    if (err.message === 'Failed to fetch') {
                        throw new Error('Erro de conexão com o servidor');
                    }
                    throw err;
                }
            },

            // Employees
            async getEmployees() {
                return this.request('/api/employees');
            },

            async createEmployee(formData) {
                return this.request('/api/employees', {
                    method: 'POST',
                    body: formData // FormData - no Content-Type header needed
                });
            },

            async deleteEmployee(id) {
                return this.request(`/api/employees/${id}`, { method: 'DELETE' });
            },

            // Evaluations
            async getEvaluations() {
                return this.request('/api/evaluations');
            },

            async createEvaluation(data) {
                return this.request('/api/evaluations', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
            },

            async getEvaluation(id) {
                return this.request(`/api/evaluations/${id}`);
            },

            async deleteEvaluation(id) {
                return this.request(`/api/evaluations/${id}`, { method: 'DELETE' });
            },

            // Dashboard
            async getDashboard() {
                return this.request('/api/dashboard');
            }
        };

        // ===========================================
        // Helper functions
        // ===========================================
        function getClassification(score) {
            if (score >= 4.5) return 'Excepcional';
            if (score >= 3.5) return 'Acima do Esperado';
            if (score >= 2.5) return 'Atende Expectativas';
            if (score >= 1.5) return 'Abaixo do Esperado';
            return 'Insatisfatório';
        }

        function getBadgeClass(score) {
            if (score >= 4.5) return 'exceptional';
            if (score >= 3.5) return 'above';
            if (score >= 2.5) return 'meets';
            if (score >= 1.5) return 'below';
            return 'unsatisfactory';
        }

        function getPhotoURL(photo) {
            if (!photo) return null;
            return `/uploads/${photo}`;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const d = new Date(dateStr);
            if (isNaN(d.getTime())) {
                // Try parsing as YYYY-MM-DD
                const parts = dateStr.split('-');
                if (parts.length === 3) {
                    return `${parts[2]}/${parts[1]}/${parts[0]}`;
                }
                return dateStr;
            }
            return d.toLocaleDateString('pt-BR');
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ===========================================
        // Navigation
        // ===========================================
        const Navigation = {
            currentPage: 'dashboard',
            
            init() {
                document.querySelectorAll('.menu-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const page = e.currentTarget.getAttribute('data-page');
                        this.goToPage(page);
                        this.closeMobileMenu();
                    });
                });

                document.getElementById('hamburger').addEventListener('click', () => {
                    this.toggleMobileMenu();
                });

                document.getElementById('overlay').addEventListener('click', () => {
                    this.closeMobileMenu();
                });

                document.getElementById('cancelEmployee').addEventListener('click', () => {
                    this.goToPage('employees');
                });

                document.getElementById('cancelEvaluation').addEventListener('click', () => {
                    this.goToPage('evaluation');
                });

                document.getElementById('backToHistory').addEventListener('click', () => {
                    this.goToPage('history');
                });
            },

            goToPage(pageName) {
                document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
                document.getElementById(`page-${pageName}`).classList.remove('hidden');
                
                document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
                document.querySelector(`[data-page="${pageName}"]`)?.classList.add('active');
                
                this.currentPage = pageName;

                // Refresh content
                if (pageName === 'dashboard') Dashboard.render();
                if (pageName === 'employees') EmployeesPage.render();
                if (pageName === 'evaluation') EvaluationPage.init();
                if (pageName === 'history') HistoryPage.render();

                // Scroll to top
                window.scrollTo(0, 0);
            },

            toggleMobileMenu() {
                document.getElementById('sidebar').classList.toggle('mobile-open');
                document.getElementById('overlay').classList.toggle('active');
            },

            closeMobileMenu() {
                document.getElementById('sidebar').classList.remove('mobile-open');
                document.getElementById('overlay').classList.remove('active');
            }
        };

        // ===========================================
        // Dashboard
        // ===========================================
        const Dashboard = {
            async render() {
                try {
                    const data = await API.getDashboard();
                    
                    document.getElementById('totalEmployees').textContent = data.totalEmployees;
                    document.getElementById('totalEvaluations').textContent = data.totalEvaluations;
                    document.getElementById('pendingEvaluations').textContent = data.pendingEvaluations;

                    if (data.averageScore !== null && data.totalEvaluations > 0) {
                        document.getElementById('averageScore').textContent = data.averageScore.toFixed(1);
                        document.getElementById('teamScoreBar').style.width = (data.averageScore * 20) + '%';
                        
                        const classification = getClassification(data.averageScore);
                        document.getElementById('teamPerformanceText').textContent = 
                            `Desempenho da equipe: ${classification} (${data.averageScore.toFixed(1)}/5.0)`;
                    } else {
                        document.getElementById('averageScore').textContent = '-';
                        document.getElementById('teamScoreBar').style.width = '0%';
                        document.getElementById('teamPerformanceText').textContent = 
                            'Nenhuma avaliação realizada ainda';
                    }

                    this.renderRecentEvaluations(data.recentEvaluations || []);
                } catch (err) {
                    console.error('Erro ao carregar dashboard:', err);
                }
            },

            renderRecentEvaluations(evaluations) {
                const container = document.getElementById('recentEvaluations');

                if (evaluations.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon"><i class="fas fa-clipboard"></i></div>
                            <div class="empty-title">Nenhuma avaliação realizada</div>
                            <div class="empty-text">As avaliações recentes aparecerão aqui</div>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = evaluations.map(ev => {
                    const employeeName = ev.employee_name || 'Funcionário Removido';
                    const classification = getClassification(ev.final_score);
                    const badgeClass = getBadgeClass(ev.final_score);

                    return `
                        <div class="evaluation-item" onclick="HistoryPage.showDetail(${ev.id})">
                            <div class="evaluation-header">
                                <div class="evaluation-employee">${escapeHtml(employeeName)}</div>
                                <div class="evaluation-score">${ev.final_score.toFixed(1)}</div>
                            </div>
                            <div class="evaluation-meta">
                                <span><i class="fas fa-calendar"></i> ${escapeHtml(ev.period)}</span>
                                <span><i class="fas fa-clock"></i> ${formatDate(ev.created_at)}</span>
                                <span class="badge ${badgeClass}">${classification}</span>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        };

        // ===========================================
        // Employees Page
        // ===========================================
        const EmployeesPage = {
            async render() {
                const container = document.getElementById('employeesList');
                container.innerHTML = '<div class="loading"><i class="fas fa-spinner"></i><p>Carregando...</p></div>';

                try {
                    const employees = await API.getEmployees();

                    if (employees.length === 0) {
                        container.innerHTML = `
                            <div class="content-card">
                                <div class="empty-state">
                                    <div class="empty-icon"><i class="fas fa-users"></i></div>
                                    <div class="empty-title">Nenhum funcionário cadastrado</div>
                                    <div class="empty-text">Comece adicionando funcionários à sua equipe</div>
                                    <button class="btn btn-primary" onclick="Navigation.goToPage('new-employee')">
                                        <i class="fas fa-user-plus"></i> Adicionar Funcionário
                                    </button>
                                </div>
                            </div>
                        `;
                        return;
                    }

                    container.innerHTML = employees.map(emp => {
                        const initials = emp.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
                        const photoUrl = getPhotoURL(emp.photo);

                        return `
                            <div class="employee-card">
                                ${photoUrl ? 
                                    `<img src="${photoUrl}" alt="${escapeHtml(emp.name)}" class="employee-photo" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">
                                     <div class="employee-photo default" style="display:none">${initials}</div>` :
                                    `<div class="employee-photo default">${initials}</div>`
                                }
                                <div class="employee-name">${escapeHtml(emp.name)}</div>
                                <div class="employee-role">${escapeHtml(emp.role)}</div>
                                <div class="employee-dept">${escapeHtml(emp.department)}</div>
                                <div style="font-size: 13px; color: var(--gray-medium); margin-bottom: 4px;">
                                    <i class="fas fa-envelope"></i> ${escapeHtml(emp.email)}
                                </div>
                                <div style="font-size: 13px; color: var(--gray-medium);">
                                    <i class="fas fa-calendar"></i> Desde ${formatDate(emp.admission_date)}
                                </div>
                                <div class="employee-actions">
                                    <button class="btn btn-primary btn-icon" onclick="EmployeesPage.evaluate(${emp.id})">
                                        <i class="fas fa-clipboard-check"></i> Avaliar
                                    </button>
                                    <button class="btn btn-danger btn-icon" onclick="EmployeesPage.deleteEmployee(${emp.id})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                    }).join('');
                } catch (err) {
                    container.innerHTML = `<div class="content-card"><p style="color:var(--danger)">Erro ao carregar funcionários: ${escapeHtml(err.message)}</p></div>`;
                }
            },

            evaluate(id) {
                Navigation.goToPage('evaluation');
                // Wait for the page to initialize, then set the employee
                setTimeout(() => {
                    document.getElementById('evalEmployee').value = id;
                }, 100);
            },

            async deleteEmployee(id) {
                if (confirm('Deseja realmente excluir este funcionário? Todas as avaliações associadas também serão excluídas. Esta ação não pode ser desfeita.')) {
                    try {
                        await API.deleteEmployee(id);
                        this.render();
                    } catch (err) {
                        alert('Erro ao excluir funcionário: ' + err.message);
                    }
                }
            }
        };

        // ===========================================
        // Employee Form
        // ===========================================
        const EmployeeForm = {
            selectedFile: null,

            init() {
                const form = document.getElementById('employeeForm');
                const uploadArea = document.getElementById('uploadArea');
                const photoInput = document.getElementById('empPhoto');
                const preview = document.getElementById('photoPreview');

                uploadArea.addEventListener('click', () => photoInput.click());

                uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadArea.style.borderColor = 'var(--primary)';
                });

                uploadArea.addEventListener('dragleave', () => {
                    uploadArea.style.borderColor = 'var(--border)';
                });

                uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadArea.style.borderColor = 'var(--border)';
                    const files = e.dataTransfer.files;
                    if (files.length) this.handlePhoto(files[0]);
                });

                photoInput.addEventListener('change', (e) => {
                    if (e.target.files.length) this.handlePhoto(e.target.files[0]);
                });

                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.save();
                });
            },

            handlePhoto(file) {
                this.selectedFile = file;
                const preview = document.getElementById('photoPreview');
                const reader = new FileReader();
                reader.onload = (e) => {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            },

            async save() {
                const name = document.getElementById('empName').value.trim();
                const role = document.getElementById('empRole').value.trim();
                const department = document.getElementById('empDepartment').value;
                const email = document.getElementById('empEmail').value.trim();
                const admission = document.getElementById('empAdmission').value;

                if (!name || !role || !department || !email || !admission) {
                    alert('Por favor, preencha todos os campos obrigatórios.');
                    return;
                }

                const formData = new FormData();
                formData.append('name', name);
                formData.append('role', role);
                formData.append('department', department);
                formData.append('email', email);
                formData.append('admission_date', admission);

                if (this.selectedFile) {
                    formData.append('photo', this.selectedFile);
                }

                try {
                    await API.createEmployee(formData);
                    alert('Funcionário cadastrado com sucesso!');
                    this.reset();
                    Navigation.goToPage('employees');
                } catch (err) {
                    alert('Erro ao salvar funcionário: ' + err.message);
                }
            },

            reset() {
                document.getElementById('employeeForm').reset();
                document.getElementById('photoPreview').style.display = 'none';
                document.getElementById('photoPreview').src = '';
                this.selectedFile = null;
            }
        };

        // ===========================================
        // Evaluation Page
        // ===========================================
        const EvaluationPage = {
            ratings: {},

            async init() {
                await this.loadEmployees();
                this.initStars();
            },

            async loadEmployees() {
                try {
                    const employees = await API.getEmployees();
                    const select = document.getElementById('evalEmployee');
                    const currentVal = select.value;
                    
                    select.innerHTML = '<option value="">Selecione um funcionário...</option>' +
                        employees.map(emp => `<option value="${emp.id}">${escapeHtml(emp.name)} - ${escapeHtml(emp.role)}</option>`).join('');
                    
                    // Restore selection if it existed
                    if (currentVal) {
                        select.value = currentVal;
                    }
                } catch (err) {
                    console.error('Erro ao carregar funcionários:', err);
                }
            },

            initStars() {
                const criteria = ['quality', 'productivity', 'technical', 'teamwork', 'initiative', 
                                'punctuality', 'leadership', 'adaptability', 'communication', 'values'];
                
                criteria.forEach(criterion => {
                    const container = document.querySelector(`[data-criterion="${criterion}"]`);
                    container.innerHTML = '';
                    
                    for (let i = 1; i <= 5; i++) {
                        const star = document.createElement('i');
                        star.className = 'fas fa-star star';
                        star.dataset.value = i;
                        
                        star.addEventListener('click', () => {
                            this.setRating(criterion, i);
                        });
                        
                        container.appendChild(star);
                    }

                    this.ratings[criterion] = 0;
                });

                // Remove old listener and add new one
                const form = document.getElementById('evaluationForm');
                const newForm = form.cloneNode(true);
                form.parentNode.replaceChild(newForm, form);
                
                // Re-init stars on cloned form
                criteria.forEach(criterion => {
                    const container = newForm.querySelector(`[data-criterion="${criterion}"]`);
                    container.innerHTML = '';
                    
                    for (let i = 1; i <= 5; i++) {
                        const star = document.createElement('i');
                        star.className = 'fas fa-star star';
                        star.dataset.value = i;
                        
                        star.addEventListener('click', () => {
                            this.setRating(criterion, i);
                        });
                        
                        container.appendChild(star);
                    }

                    this.ratings[criterion] = 0;
                });

                newForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveEvaluation();
                });

                // Re-bind cancel button
                newForm.querySelector('#cancelEvaluation')?.addEventListener('click', () => {
                    Navigation.goToPage('evaluation');
                });
            },

            setRating(criterion, value) {
                this.ratings[criterion] = value;
                
                const stars = document.querySelectorAll(`[data-criterion="${criterion}"] .star`);
                stars.forEach((star, index) => {
                    if (index < value) {
                        star.classList.add('active');
                    } else {
                        star.classList.remove('active');
                    }
                });

                const container = document.querySelector(`[data-criterion="${criterion}"]`).parentElement;
                const ratingText = container.querySelector('.rating-value');
                ratingText.textContent = `Nota: ${value}/5`;
            },

            async saveEvaluation() {
                const employeeId = document.getElementById('evalEmployee').value;
                const period = document.getElementById('evalPeriod').value;

                if (!employeeId) {
                    alert('Por favor, selecione um funcionário');
                    return;
                }

                if (!period) {
                    alert('Por favor, informe o período');
                    return;
                }

                const allRated = Object.values(this.ratings).every(r => r > 0);
                if (!allRated) {
                    alert('Por favor, avalie todos os critérios');
                    return;
                }

                const data = {
                    employee_id: parseInt(employeeId),
                    period: period,
                    quality: this.ratings.quality,
                    productivity: this.ratings.productivity,
                    technical: this.ratings.technical,
                    teamwork: this.ratings.teamwork,
                    initiative: this.ratings.initiative,
                    punctuality: this.ratings.punctuality,
                    leadership: this.ratings.leadership,
                    adaptability: this.ratings.adaptability,
                    communication: this.ratings.communication,
                    values_alignment: this.ratings.values,
                    strengths: document.getElementById('evalStrengths').value,
                    improvements: document.getElementById('evalImprovements').value,
                    pdi: document.getElementById('evalPDI').value
                };

                try {
                    await API.createEvaluation(data);
                    alert('Avaliação salva com sucesso!');
                    this.reset();
                    Navigation.goToPage('history');
                } catch (err) {
                    alert('Erro ao salvar avaliação: ' + err.message);
                }
            },

            reset() {
                document.getElementById('evaluationForm').reset();
                Object.keys(this.ratings).forEach(criterion => {
                    this.ratings[criterion] = 0;
                    const stars = document.querySelectorAll(`[data-criterion="${criterion}"] .star`);
                    stars.forEach(star => star.classList.remove('active'));
                    const container = document.querySelector(`[data-criterion="${criterion}"]`)?.parentElement;
                    if (container) {
                        const ratingText = container.querySelector('.rating-value');
                        if (ratingText) ratingText.textContent = '';
                    }
                });
            }
        };

        // ===========================================
        // History Page
        // ===========================================
        const HistoryPage = {
            async render() {
                const container = document.getElementById('evaluationsList');
                container.innerHTML = '<div class="loading"><i class="fas fa-spinner"></i><p>Carregando...</p></div>';

                try {
                    const evaluations = await API.getEvaluations();

                    if (evaluations.length === 0) {
                        container.innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon"><i class="fas fa-history"></i></div>
                                <div class="empty-title">Nenhuma avaliação realizada</div>
                                <div class="empty-text">As avaliações aparecerão aqui após serem criadas</div>
                                <button class="btn btn-primary" onclick="Navigation.goToPage('evaluation')">
                                    <i class="fas fa-clipboard-check"></i> Criar Primeira Avaliação
                                </button>
                            </div>
                        `;
                        return;
                    }

                    container.innerHTML = evaluations.map(ev => {
                        const employeeName = ev.employee_name || 'Funcionário Removido';
                        const classification = getClassification(ev.final_score);
                        const badgeClass = getBadgeClass(ev.final_score);

                        return `
                            <div class="evaluation-item" onclick="HistoryPage.showDetail(${ev.id})">
                                <div class="evaluation-header">
                                    <div class="evaluation-employee">${escapeHtml(employeeName)}</div>
                                    <div class="evaluation-score">${ev.final_score.toFixed(1)}</div>
                                </div>
                                <div class="evaluation-meta">
                                    <span><i class="fas fa-calendar"></i> ${escapeHtml(ev.period)}</span>
                                    <span><i class="fas fa-clock"></i> ${formatDate(ev.created_at)}</span>
                                    <span class="badge ${badgeClass}">${classification}</span>
                                </div>
                            </div>
                        `;
                    }).join('');
                } catch (err) {
                    container.innerHTML = `<p style="color:var(--danger)">Erro ao carregar avaliações: ${escapeHtml(err.message)}</p>`;
                }
            },

            async showDetail(evalId) {
                try {
                    const evaluation = await API.getEvaluation(evalId);
                    
                    if (!evaluation) return;

                    const employeeName = evaluation.employee_name || 'Funcionário Removido';
                    
                    document.getElementById('detailTitle').textContent = `Avaliação - ${employeeName}`;
                    document.getElementById('detailSubtitle').textContent = 
                        `${evaluation.period} • ${formatDate(evaluation.created_at)}`;

                    const classification = getClassification(evaluation.final_score);
                    const badgeClass = getBadgeClass(evaluation.final_score);

                    const criteriaData = [
                        { name: 'Qualidade do Trabalho', value: evaluation.quality },
                        { name: 'Produtividade', value: evaluation.productivity },
                        { name: 'Conhecimento Técnico', value: evaluation.technical },
                        { name: 'Trabalho em Equipe', value: evaluation.teamwork },
                        { name: 'Iniciativa e Proatividade', value: evaluation.initiative },
                        { name: 'Pontualidade e Assiduidade', value: evaluation.punctuality },
                        { name: 'Liderança', value: evaluation.leadership },
                        { name: 'Adaptabilidade', value: evaluation.adaptability },
                        { name: 'Comunicação', value: evaluation.communication },
                        { name: 'Alinhamento com Valores', value: evaluation.values_alignment }
                    ];

                    const detailHTML = `
                        <div class="detail-section">
                            <div style="text-align: center; margin-bottom: 24px;">
                                <div style="font-size: 48px; font-weight: 700; color: var(--primary);">
                                    ${evaluation.final_score.toFixed(1)}
                                </div>
                                <div class="badge ${badgeClass}" style="font-size: 14px; padding: 6px 16px;">
                                    ${classification}
                                </div>
                            </div>
                        </div>

                        <div class="detail-section">
                            <div class="detail-title">Critérios Avaliados</div>
                            <div class="criteria-grid">
                                ${criteriaData.map(c => `
                                    <div class="criteria-item">
                                        <div class="criteria-name">${c.name}</div>
                                        <div class="criteria-score">${c.value}/5</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        ${evaluation.strengths ? `
                            <div class="detail-section">
                                <div class="detail-title">Pontos Fortes</div>
                                <div class="text-content">${escapeHtml(evaluation.strengths)}</div>
                            </div>
                        ` : ''}

                        ${evaluation.improvements ? `
                            <div class="detail-section">
                                <div class="detail-title">Pontos de Melhoria</div>
                                <div class="text-content">${escapeHtml(evaluation.improvements)}</div>
                            </div>
                        ` : ''}

                        ${evaluation.pdi ? `
                            <div class="detail-section">
                                <div class="detail-title">Plano de Desenvolvimento Individual (PDI)</div>
                                <div class="text-content">${escapeHtml(evaluation.pdi)}</div>
                            </div>
                        ` : ''}
                    `;

                    document.getElementById('evaluationDetail').innerHTML = detailHTML;
                    
                    document.getElementById('deleteEvaluation').onclick = async () => {
                        if (confirm('Deseja realmente excluir esta avaliação?')) {
                            try {
                                await API.deleteEvaluation(evalId);
                                Navigation.goToPage('history');
                            } catch (err) {
                                alert('Erro ao excluir avaliação: ' + err.message);
                            }
                        }
                    };

                    // Show the detail page
                    document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
                    document.getElementById('page-evaluation-detail').classList.remove('hidden');
                    document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
                    window.scrollTo(0, 0);
                } catch (err) {
                    alert('Erro ao carregar detalhes da avaliação: ' + err.message);
                }
            }
        };

        // ===========================================
        // Initialize App
        // ===========================================
        document.addEventListener('DOMContentLoaded', () => {
            Navigation.init();
            EmployeeForm.init();
            Dashboard.render();
        });
    </script>
</body>
</html>
